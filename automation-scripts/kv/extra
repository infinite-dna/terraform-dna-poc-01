- name: Retrieve certificate from Azure Key Vault using Vault URI
  hosts: localhost
  tasks:
    - name: Get certificate from Key Vault
      azure.azcollection.azure_rm_keyvault:
        vault_uri: "https://<your-keyvault-name>.vault.azure.net/"  # Key Vault URI
        client_id: "{{ client_id }}"
        secret: "{{ secret }}"
        tenant: "{{ tenant }}"
        certificates:
          - name: "<your-certificate-name>"
            export: true  # Set to true to export the certificate
      register: cert

    - name: Write certificate to file
      copy:
        content: "{{ cert.certificates[0].cer }}"  # The base64-encoded certificate
        dest: "/path/to/save/certificate.pem"
        mode: '0644'
